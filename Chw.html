<html>

<head>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/muzima.css" rel="stylesheet">
    <link href="css/ui-darkness/jquery-ui-1.10.4.custom.min.css" rel="stylesheet">
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui-1.10.4.custom.min.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/additional-methods.min.js"></script>
    <script src="js/muzima.js"></script>

    <title>CDM CHW Form</title>
</head>

<body class="col-md-10 col-md-offset-1">
<form id="via_form" name="via_form">
<h2 class="text-center">CDM CHW Form</h2>

<div class="section">
    <h3>Demographics</h3>

    <div class="form-group">
        <input class="form-control" id="patient.uuid" name="patient.uuid" type="hidden" readonly="readonly">
    </div>
    <div class="form-group">
        <label for="patient.medical_record_number">AMRS ID Number:</label>
        <input class="form-control" id="patient.medical_record_number" name="patient.medical_record_number" type="text"
               readonly="readonly" disabled="disabled">
    </div>
    <div class="form-group">
        <label for="patient.family_name">Family Name:</label>
        <input class="form-control" id="patient.family_name" name="patient.family_name" type="text" readonly="readonly"
               disabled="disabled">
    </div>
    <div class="form-group">
        <label for="patient.given_name">Given Name:</label>
        <input class="form-control" id="patient.given_name" name="patient.given_name" type="text" readonly="readonly"
               disabled="disabled">
    </div>
    <div class="form-group">
        <label for="patient.middle_name">Middle Name:</label>
        <input class="form-control" id="patient.middle_name" name="patient.middle_name" type="text" readonly="readonly"
               disabled="disabled">
    </div>
    <div class="form-group">
        <label for="patient.sex">Gender:</label>
        <select class="form-control" id="patient.sex" name="patient.sex">
            <option value="">...</option>
            <option value="M">Male</option>
            <option value="F">Female</option>
        </select>
    </div>
    <div class="form-group">
        <label for="patient.birthdate">Date Of Birth:</label>
        <input class="form-control datepicker nonFutureDate" id="patient.birthdate" name="patient.birthdate" type="date"
               readonly="readonly" disabled="disabled">
    </div>
</div>

<div class="section">
    <div class="form-group">
        <label for="encounter.location_id">Screening Site:<span class="required">*</span></label>
        <select class="form-control" name="encounter.location_id" id="encounter.location_id" required="required">
            <option value="">...</option>
            <option value="3">Turbo</option>
            <option value="2">Mosoriot</option>
            <option value="7">Chulaimbo</option>
            <option value="8">Webuye</option>
            <option value="9">Ampath MTRH</option>
            <option value="17">Iten</option>
        </select>
    </div>

    <div class="form-group">
        <label for="encounter.encounter_datetime">
            Encounter Date:<span class="required">*</span>
        </label>
        <input class="form-control datepicker nonFutureDate" id="encounter.encounter_datetime"
               name="encounter.encounter_datetime" type="text" readonly="readonly" encounter.encounter_datetime
               required="required">
    </div>
    <div class="form-group">
        <input class="form-control" id="encounter.form_uuid" name="encounter.form_uuid" type="hidden"
               required="required">
    </div>
</div>

<div class="section">
    <div class="form-group">
        <label for="previous_follow_up">Previous date this form was filled:</label>
        <input class="form-control datepicker nonFutureDate" id="previous_follow_up"
               name="previous_follow_up" type="text"
               data-concept="9167^DATE OF LAST FOLLOW-UP^99DCT">
    </div>
    <div class="form-group">
        <label for="missed_appointment_date">Missed appointment date:</label>
        <input class="form-control datepicker nonFutureDate" id="missed_appointment_date"
               name="missed_appointment_date" type="text"
               data-concept="1592^MISSED APPOINTMENT DATE^99DCT">
    </div>
</div>

<div class="section">
    <h4>PHCT Blood Sugar Readings</h4>

    <div class="form-group">
        <label for="random_blood_sugar">Random blood sugar (RBS):</label>

        <div class="input-group">
            <input class="form-control" id="random_blood_sugar"
                   name="random_blood_sugar" type="number"
                   data-concept="887^SERUM GLUCOSE^99DCT">
            <span class="input-group-addon">mmol/L</span>
        </div>
    </div>
    <div class="form-group">
        <label for="random_blood_sugar">Fasting blood sugar (FBS):</label>

        <div class="input-group">
            <input class="form-control" id="fasting_blood_sugar"
                   name="fasting_blood_sugar" type="number"
                   data-concept="6252^SERUM GLUCOSE, FASTING^99DCT">
            <span class="input-group-addon">mmol/L</span>
        </div>
    </div>
</div>

<div class="section">
    <h4>PHCT Blood Pressure Readings</h4>

    <div class="form-group">
        <label for="random_blood_sugar">Systolic blood pressure:</label>

        <div class="input-group">
            <input class="form-control" id="systolic_blood_pressure"
                   name="systolic_blood_pressure" type="number"
                   data-concept="5085^SYSTOLIC BLOOD PRESSURE^99DCT">
            <span class="input-group-addon">mmHg</span>
        </div>
    </div>
    <div class="form-group">
        <label for="diastolic_blood_pressure">Diastolic blood pressure:</label>

        <div class="input-group">
            <input class="form-control" id="diastolic_blood_pressure"
                   name="diastolic_blood_pressure" type="number"
                   data-concept="5086^DIASTOLIC BLOOD PRESSURE^99DCT">
            <span class="input-group-addon">mmHg</span>
        </div>
    </div>
</div>

<div class="section" data-concept="1932^REFERRALS ORDERED, DETAILED^99DCT">
    <div class="form-group">
        <label for="referrals_ordered">Name of facility client was referred to:</label>
        <input class="form-control" id="referrals_ordered"
               name="referrals_ordered" type="text"
               data-concept="1272^REFERRALS ORDERED^99DCT">
    </div>
    <div class="form-group">
        <label for="date_referred">Date referred:</label>
        <input class="form-control datepicker nonFutureDate" id="date_referred"
               name="date_referred" type="text"
               data-concept="9158^DATE REFERRED^99DCT">
    </div>
</div>

<div class="section" data-concept="6750^REFERRED BY, DETAILED^99DCT">
    <h4>Client referred from:</h4>

    <div class="form-group">
        <label class="font-normal">
            <input id="referred_by.phct" type="checkbox"
                   data-concept="6749^REFERRED BY^99DCT"
                   value="8227^PHCT^99DCT">
            PHCT
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="referred_by.mch" type="checkbox"
                   data-concept="6749^REFERRED BY^99DCT"
                   value="2050^MATERNAL CHILD HEALTH PROGRAM^99DCT">
            MCH
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="referred_by.clinic" type="checkbox"
                   data-concept="6749^REFERRED BY^99DCT"
                   value="7037^REFERRED FROM CLINIC^99DCT">
            Clinic
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input class="has-other" id="referred_by.other_non_coded" type="checkbox"
                   data-concept="6749^REFERRED BY^99DCT"
                   value="5622^OTHER NON-CODED^99DCT">
            Other
        </label>
    </div>
    <div class="form-group freetext">
        <label for="referred_by.freetext_general">Specify</label>
        <input class="form-control" id="referred_by.freetext_general"
               name="referred_by.freetext_general" type="text"
               data-concept="1915^FREETEXT GENERAL^99DCT">
    </div>
</div>

<div class="section" data-concept="9168^TYPE OF FOLLOW-UP, DETAILED^99DCT">
    <h4>Type of CHW follow up:</h4>

    <div class="form-group">
        <label class="font-normal">
            <input id="follow_up_type.hypertension" type="checkbox"
                   data-concept="2332^TYPE OF FOLLOW-UP^99DCT"
                   value="7286^KNOWN HYPERTENSIVE PATIENT^99DCT">
            Hypertension
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="follow_up_type.diabetic" type="checkbox"
                   data-concept="2332^TYPE OF FOLLOW-UP^99DCT"
                   value="7282^KNOWN DIABETIC PATIENT^99DCT">
            Diabetic
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input class="has-other" id="follow_up_type.other_non_coded" type="checkbox"
                   data-concept="2332^TYPE OF FOLLOW-UP^99DCT"
                   value="5622^OTHER NON-CODED^99DCT">
            Other
        </label>
    </div>
    <div class="form-group freetext">
        <label for="follow_up_type.freetext_general">Specify</label>
        <input class="form-control" id="follow_up_type.freetext_general"
               name="follow_up_type.freetext_general" type="text"
               data-concept="1915^FREETEXT GENERAL^99DCT">
    </div>
</div>

<div class="section" data-concept="6114^REASON FOR ATTEMPTED CONTACT, DETAILED^99DCT">
    <h4>Reason for follow up:</h4>

    <div class="form-group">
        <label class="font-normal">
            <input id="follow_up_category.not_linked_to_care" type="checkbox"
                   data-concept="9081^PATIENT ON OUTREACH FOLLOW-UP CATEGORY^99DCT"
                   value="9160^NOT LINKED TO CARE^99DCT">
            Not linked to care
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="follow_up_category.lost_to_follow_up" type="checkbox"
                   data-concept="9081^PATIENT ON OUTREACH FOLLOW-UP CATEGORY^99DCT"
                   value="9159^LOST TO FOLLOW-UP, NOS^99DCT">
            Lost to follow up
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input class="has-other" id="follow_up_category.other_non_coded" type="checkbox"
                   data-concept="9081^PATIENT ON OUTREACH FOLLOW-UP CATEGORY^99DCT"
                   value="5622^OTHER NON-CODED^99DCT">
            Other
        </label>
    </div>
    <div class="form-group freetext">
        <label for="follow_up_category.freetext_general">Specify</label>
        <input class="form-control" id="follow_up_category.freetext_general"
               name="follow_up_category.freetext_general" type="text"
               data-concept="1915^FREETEXT GENERAL^99DCT">
    </div>
</div>

<div class="section" data-concept="6187^REASON FOR MISSED VISIT, DETAILED^99DCT">
    <h4>Reason for missed appointment:</h4>

    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.lack_of_time" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="9148^COMMITMENTS^99DCT">
            Lack of time
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.lack_of_money" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="6295^FINANCIAL BARRIER^99DCT">
            Lack of money
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.lack_of_confidence" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="9161^LACK OF CONFIDENCE^99DCT">
            Lack of confidence in health care worker(s)
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.lack_of_transport" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="820^TRANSPORT PROBLEMS^99DCT">
            Lack of transport
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.asymptomatic" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="5006^ASYMPTOMATIC^99DCT">
            No symptoms of illness
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.visited_not_seen" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="9162^VISITED HEALTH CARE FACILITY, NOT SEEN^99DCT">
            Visited not seen
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.visited_dispensary_closed" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="9163^VISITED HEALTH CARE FACILITY, CLOSED^99DCT">
            Visited dispensary closed
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.distance_too_far" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="1551^DISTANCE TOO FAR^99DCT">
            Distance (too far)
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input id="missed_visit_reason.sought_care_elsewhere" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="8352^CONTINUE TO RECEIVE MEDICATIONS FROM ANOTHER LOCATION^99DCT">
            Sought care elsewhere
        </label>
    </div>
    <div class="form-group">
        <label class="font-normal">
            <input class="has-other" id="missed_visit_reason.other_non_coded" type="checkbox"
                   data-concept="1733^REASON FOR MISSED VISIT^99DCT"
                   value="5622^OTHER NON-CODED^99DCT">
            Other
        </label>
    </div>
    <div class="form-group freetext">
        <label for="missed_visit_reason.freetext_general">Specify</label>
        <input class="form-control" id="missed_visit_reason.freetext_general"
               name="missed_visit_reason.freetext_general" type="text"
               data-concept="1915^FREETEXT GENERAL^99DCT">
    </div>
</div>

<div class="section">
    <div class="form-group">
        <span><strong>Are you currently on any treatment/ medication?</strong></span>

        <div class="radio">
            <label>
                <input name="currently_on_medication" type="radio"
                       data-concept="1193^CURRENT MEDICATIONS^99DCT"
                       value="1065^YES^99DCT">
                Yes
            </label>
        </div>
        <div class="radio">
            <label>
                <input name="currently_on_medication" type="radio"
                       data-concept="1193^CURRENT MEDICATIONS^99DCT"
                       value="1066^NO^99DCT">
                No
            </label>
        </div>
    </div>
    <div class="repeating" data-name="current_medication">
        <div class="form-group">
            <label>Specify the medication:</label>
            <input class="form-control current_medication" name="current_medication" type="text"
                   data-concept="1193^CURRENT MEDICATIONS^99DCT^1">
        </div>
    </div>
</div>

<div class="section">
    <div class="form-group">
        <span><strong>Are you enrolled to care in another facility?</strong></span>

        <div class="radio">
            <label>
                <input name="enrolled_in_other" type="radio"
                       data-concept="9164^ENROLL CARE IN ANOTHER HEALTH FACILITY^99DCT"
                       value="1065^YES^99DCT">
                Yes
            </label>
        </div>
        <div class="radio">
            <label>
                <input name="enrolled_in_other" type="radio"
                       data-concept="9164^ENROLL CARE IN ANOTHER HEALTH FACILITY^99DCT"
                       value="1066^NO^99DCT">
                No
            </label>
        </div>
    </div>
    <div class="form-group">
        <label for="current_facility">If enrolled in another facility, where?</label>
        <input class="form-control" id="current_facility"
               name="current_facility" type="text"
               data-concept="9165^NAME OF FACILITY TO WHICH PATIENT IS ENROLLED^99DCT">
    </div>
    <div class="form-group">
        <span><strong>If No, are you planning to resume care?</strong></span>

        <div class="radio">
            <label>
                <input name="planning_to_resume" type="radio"
                       data-concept="6140^PLAN TO RETURN TO CLINIC^99DCT"
                       value="1065^YES^99DCT">
                Yes
            </label>
        </div>
        <div class="radio">
            <label>
                <input name="planning_to_resume" type="radio"
                       data-concept="6140^PLAN TO RETURN TO CLINIC^99DCT"
                       value="1066^NO^99DCT">
                No
            </label>
        </div>
    </div>
    <div class="form-group">
        <label for="resume_care_date">If planning to resume care, when?</label>
        <input class="form-control datepicker nonFutureDate" id="resume_care_date"
               name="resume_care_date" type="text"
               data-concept="7348^RETURN VISIT DATE, DISPENSARY^99DCT">
    </div>
    <div class="concept-set form-group" data-concept="9087^FACILITY TYPE, DETAILED^99DCT">
        <label for="resume_care_facility">Which facility?</label>
        <input class="form-control" id="resume_care_facility"
               name="resume_care_facility" type="text"
               data-concept="9086^FACILITY TYPE^99DCT">
    </div>
</div>

<div class="section">
    <div class="form-group">
        <label for="referred_to">Referred to?</label>
        <input class="form-control" id="referred_to"
               name="referred_to" type="text"
               data-concept="7637^NAME OF FACILITY TO WHICH PATIENT IS REFERRED, FREETEXT^99DCT">
    </div>
    <div class="form-group">
        <label for="referred_to_date">Date:</label>
        <input class="form-control datepicker checkFutureDate" id="referred_to_date"
               name="referred_to_date" type="text"
               data-concept="5096^RETURN VISIT DATE^99DCT">
    </div>
    <div class="form-group">
        <label for="planned_follow_up_date">Planned CHW follow up date?</label>
        <input class="form-control datepicker nonFutureDate" id="planned_follow_up_date"
               name="planned_follow_up_date" type="text"
               data-concept="9166^PLANNED FOLLOW-UP DATE^99DCT">
    </div>
</div>

<div class="section">
    <div class="form-group">
        <label for="encounter.provider_id_select">Provider Name:</label>
        <input class="form-control" id="encounter.provider_id_select" type="text"
               placeholder="Start typing provider name here ...">
        <input class="form-control" name="encounter.provider_id_select" type="hidden">
    </div>
    <div class="form-group show_provider_id_text">
        <label for="encounter.provider_id">Enter provider's system-id:<span class="required">*</span></label>
        <input class="form-control checkDigit" id="encounter.provider_id" name="encounter.provider_id" type="text"
               placeholder="Or enter the provider system id here ..." required="required">
    </div>
    <div class="form-group">
        <label for="return_visit_date">Return visit date:</label>
        <input class="form-control datepicker checkFutureDate" data-concept="5096^RETURN VISIT DATE^99DCT"
               id="return_visit_date" name="return_visit_date" type="text"
               readonly="readonly">
    </div>
</div>

<div class="form-group text-center">
    <input class="btn btn-primary" id="save_draft" type="button" value="Save"/>
    <input class="btn btn-primary" id="submit_form" type="button" value="Submit"/>
</div>
</form>
</body>
<script type="text/javascript">

$(document).ready(function () {

    var dateFormat = "dd-mm-yy";
    var currentDate = $.datepicker.formatDate(dateFormat, new Date());
    $('#encounter\\.encounter_datetime').val(currentDate);

    $('#save_draft').click(function () {
        $(this).prop('disabled', true);
        document.saveDraft(this);
        $(this).prop('disabled', false);
    });

    $('#submit_form').click(function () {
        $(this).prop('disabled', true);
        document.submit();
        $(this).prop('disabled', false);
    });

    $('#via_form').validate({
        rules: {
            gravida: {
                number: true,
                min: 0
            },
            parity: {
                number: true,
                min: 0
            },
            last_cd4_by_facs: {
                number: true,
                range: [0, 1500]
            },
            clock_face_cervical_biopsy_location: {
                number: true,
                range: [1, 12]
            }
        }
    });

    var locationName = [
        {"val": "7", "label": "Chulaimbo"},
        {"val": "3", "label": "Turbo"},
        {"val": "17", "label": "Iten"},
        {"val": "2", "label": "Mosoriot"},
        {"val": "8", "label": "Webuye"},
        {"val": "9", "label": "Ampath MTRH"}
    ];
    $('#encounter\\.location_id').autocomplete({
        source: locationName,
        create: function (event, ui) {
            var location_val = $('input[name="encounter\\.location_id"]').val();
            $.each(locationName, function (i, elem) {
                if (elem.val == location_val) {
                    $('#encounter\\.location_id').val(elem.label)
                }
                ;
            });
        },
        select: function (event, ui) {
            $('input[name="encounter\\.location_id"]').val(ui.item.val);
            $('#encounter\\.location_id').val(ui.item.label);
            return false;
        }
    });

    var provider = [
        {"label": "Daurine Achieng Agumba", "val": "3419-9"},
        {"label": "Irene Chepkosgei	Kurgat", "val": "3420-7"},
        {"label": "Rose	Cheruto	Toroitich", "val": "3421-5"},
        {"label": "Mary	Kipkurui Kimosop", "val": "3422-3"},
        {"label": "Jacqueline Chemom Ndiema", "val": "3423-1"},
        {"label": "Grace Wanjiru Mwangi", "val": "3424-9"},
        {"label": "Collette	Mabia Palapala", "val": "3425-6"},
        {"label": "Dorice Erima	Wekesa	Female", "val": "3426-4"},
        {"label": "Agnes Kagure	Boen", "val": "120-6"},
        {"label": "Linet Kerubo	Onyancha", "val": "3427-2"},
        {"label": "Delinah Muchai Tanui", "val": "1208-8"},
        {"label": "Hellen Mushimbi Indumbwe", "val": "1208-8"},
        {"label": "Lydia Cherugut Samoei", "val": "1525-5"},
        {"label": "Ruth	Kalunda	Nzili", "val": "1529-7"},
        {"label": "Lucy	Cheruto	Birgen", "val": "3428-0"},
        {"label": "Gratiah Nafuna Khaemba", "val": "1409-2"},
        {"label": "Leonida Chemutai	Mengich", "val": "1357-3"},
        {"label": "Ann Wangoi Maina", "val": "1412-6"},
        {"label": "Elkanah Omenge Orango", "val": "1474-6"},
        {"label": "Peter Mukhanadale Istura", "val": "1478-7"},
        {"label": "Hillary Mabeya", "val": "1476-1"},
        {"label": "Astrid Christoffersen Deb", "val": "1237-7"},
        {"label": "Philip Kipkirui Tonui", "val": "1485-7"}
    ];

    $('#encounter\\.provider_id_select').autocomplete({
        source: provider,
        create: function (event, ui) {
            var provider_val = $('input[name="encounter\\.provider_id_select"]').val();
            $.each(provider, function (i, elem) {
                if (elem.val == provider_val) {
                    $('#encounter\\.provider_id_select').val(elem.label)
                }
            });
        },
        select: function (event, ui) {
            $('input[name="encounter\\.provider_id_select"]').val(ui.item.val);
            $('#encounter\\.provider_id_select').val(ui.item.label);
            $('#encounter\\.provider_id').val(ui.item.val);
            $('.show_provider_id_text').hide();
            return false;
        }
    });
    $('#encounter\\.provider_id_select').change(function () {
        if ($('#encounter\\.provider_id_select').val() === '') {
            $('#encounter\\.provider_id').val('');
            $('.show_provider_id_text').show();
        }
    });

    /* Start - Toggle free text element */
    var $hasOther = $('.has-other');
    $hasOther.change(function () {
        var hasOtherValue = $(this).val();
        var $freetext = $(this).closest('.section').find('.freetext');
        if ($(this).is(':checkbox')) {
            if ($hasOther.is(':checked')) {
                $freetext.show();
            } else {
                $freetext.hide();
            }
        } else {
            if (hasOtherValue === '5622^OTHER NON-CODED^99DCT') {
                $freetext.show();
            } else {
                $freetext.hide();
            }
        }
    });
    $hasOther.trigger('change');
    /* End - Toggle free text element */

    /* Start - Toggle medications */
    var $onMedication = $(':radio[data-concept="1193^CURRENT MEDICATIONS^99DCT"]');
    $onMedication.change(function () {
        var onMedicationValue = $(this).val();
        var $currentMedication = $('input[data-concept="1193^CURRENT MEDICATIONS^99DCT^1"]').closest(".repeating");
        if ($(this).is(':checked')) {
            if (onMedicationValue == '1065^YES^99DCT') {
                $currentMedication.show();
            } else if (onMedicationValue == '1066^NO^99DCT') {
                $currentMedication.hide();
            }
        } else {
            $currentMedication.hide();
        }
    });
    $onMedication.trigger('change');
    /* End - Toggle medications */

    /* Start - Toggle resume date and facility */
    var RETURN_PLAN_CONCEPT = "6140^PLAN TO RETURN TO CLINIC^99DCT";
    var $resumeCare = $(':radio[data-concept="' + RETURN_PLAN_CONCEPT + '"]');
    $resumeCare.change(function () {
        var resumeCareValue = $(this).val();
        var FACILITY_TYPE_CONCEPT = "9086^FACILITY TYPE^99DCT";
        var RETURN_DISPENSARY_CONCEPT = "7348^RETURN VISIT DATE, DISPENSARY^99DCT";
        var $resumeCareDate = $('input[data-concept="' + RETURN_DISPENSARY_CONCEPT + '"]').closest('.form-group');
        var $resumeCareFacility = $('input[data-concept="' + FACILITY_TYPE_CONCEPT + '"]').closest('.form-group');
        if ($(this).is(':checked')) {
            if (resumeCareValue == '1065^YES^99DCT') {
                $resumeCareDate.show();
                $resumeCareFacility.show();
            } else if (resumeCareValue == '1066^NO^99DCT') {
                $resumeCareDate.hide();
                $resumeCareFacility.hide();
            }
        } else {
            $resumeCareDate.hide();
            $resumeCareFacility.hide();
        }
    });
    $resumeCare.trigger('change');
    /* End - Toggle resume date and facility */

    /* Start - Toggle facility */
    var OTHER_FACILITY_CONCEPT = "9164^ENROLL CARE IN ANOTHER HEALTH FACILITY^99DCT";
    var $enrolled = $(':radio[data-concept="' + OTHER_FACILITY_CONCEPT + '"]');
    $enrolled.change(function () {
        var enrolledValue = $(this).val();
        var RETURN_PLAN_CONCEPT = "6140^PLAN TO RETURN TO CLINIC^99DCT";
        var FACILITY_ENROLLED_CONCEPT = "9165^NAME OF FACILITY TO WHICH PATIENT IS ENROLLED^99DCT";
        var $resumeCare = $(':radio[data-concept="' + RETURN_PLAN_CONCEPT + '"]').closest('.form-group');
        var $enrolledFacility = $('input[data-concept="' + FACILITY_ENROLLED_CONCEPT + '"]').closest('.form-group');
        if ($(this).is(':checked')) {
            if (enrolledValue == '1065^YES^99DCT') {
                $resumeCare.find(":radio").prop("checked", false).trigger('change');
                $resumeCare.hide();
                $enrolledFacility.show();
            } else if (enrolledValue == '1066^NO^99DCT') {
                $resumeCare.find(":radio").prop("checked", false).trigger('change');
                $resumeCare.show();
                $enrolledFacility.hide();
            }
        } else {
            $resumeCare.hide();
            $enrolledFacility.hide();
        }
    });
    $enrolled.trigger('change');
    /* End - Toggle facility */

    var medications = [
        {"label": "DAPSONE", "value": 92},
        {"label": "STREPTOMYCIN", "value": 438},
        {"label": "MULTIVITAMIN", "value": 461},
        {"label": "ISONIAZID", "value": 656},
        {"label": "ETHAMBUTOL", "value": 745},
        {"label": "FLUCONAZOLE", "value": 747},
        {"label": "RIFAMPICIN ISONIAZID AND PYRAZINAMIDE", "value": 768},
        {"label": "TRIMETHOPRIM AND SULFAMETHOXAZOLE", "value": 916},
        {"label": "NYSTATIN", "value": 919},
        {"label": "UNKNOWN", "value": 1067},
        {"label": "RIFAMPICIN ISONIAZID PYRAZINAMIDE AND ETHAMBUTOL", "value": 1131},
        {"label": "RIFAMPICIN AND ISONIAZID", "value": 1194},
        {"label": "ANTIBIOTICS", "value": 1195},
        {"label": "OTHER NON-CODED", "value": 5622},
        {"label": "ANTIMALARIAL MEDICATIONS", "value": 5839},
        {"label": "HERBAL TRADITIONAL MEDICATIONS", "value": 5841},
        {"label": "MINERALS IRON SUPPLEMENTS", "value": 5843},
        {"label": "NONE", "value": 1107},
        {"label": "RIFAMPICIN ISONIAZID AND ETHAMBUTOL", "value": 2231},
        {"label": "ETHAMBUTOL AND ISONIZAID", "value": 1108},
        {"label": "RIFAMPICIN", "value": 767},
        {"label": "PYRAZINAMIDE", "value": 5829},
        {"label": "NSAIDS", "value": 6476},
        {"label": "DIHYDROCODEINE", "value": 743},
        {"label": "MORPHINE", "value": 6477},
        {"label": "ZIDOVUDINE AND LAMIVUDINE", "value": 630},
        {"label": "STAVUDINE LAMIVUDINE AND NEVIRAPINE", "value": 792},
        {"label": "EMTRICITABINE AND TENOFOVIR", "value": 6180},
        {"label": "NEVIRAPINE", "value": 631},
        {"label": "LAMIVUDINE", "value": 628},
        {"label": "ZIDOVUDINE", "value": 797},
        {"label": "STAVUDINE", "value": 625},
        {"label": "EFAVIRENZ", "value": 633},
        {"label": "ABACAVIR", "value": 814},
        {"label": "LOPINAVIR AND RITONAVIR", "value": 794},
        {"label": "DIDANOSINE", "value": 796},
        {"label": "TENOFOVIR", "value": 802},
        {"label": "INDINAVIR", "value": 749},
        {"label": "RALTEGRAVIR", "value": 6156},
        {"label": "PEDIATRIC RIFAMPICIN ISONIAZID AND PYRAZINAMIDE", "value": 6602},
        {"label": "PEDIATRIC RIFAMPICIN AND ISONIAZID", "value": 6603},
        {"label": "METFORMIN", "value": 2261},
        {"label": "GLIBENCLAMIDE", "value": 2257},
        {"label": "ENALAPRIL", "value": 1242},
        {"label": "HYDROCHLOROTHIAZIDE", "value": 1243},
        {"label": "LOSARTAN", "value": 2265},
        {"label": "NIFEDIPINE", "value": 250},
        {"label": "FLUOXETINE", "value": 2281},
        {"label": "OLANZAPINE", "value": 2282},
        {"label": "ALPRAZOLAM", "value": 733},
        {"label": "AMITRIPTYLINE", "value": 2273},
        {"label": "BENZHEXOL", "value": 7578},
        {"label": "CARBAMAZEPINE", "value": 920},
        {"label": "CHLORPROMAZINE", "value": 914},
        {"label": "FLUPHENAZINE", "value": 927},
        {"label": "HALOPERIDOL", "value": 2283},
        {"label": "IMIPRAMINE", "value": 748},
        {"label": "VALPROATE SODIUM", "value": 2284},
        {"label": "ANTIRETROVIRAL DRUGS", "value": 1085},
        {"label": "VITAMINS", "value": 6339},
        {"label": "MALARIA PROPHYLAXIS", "value": 6338},
        {"label": "IRON SUPPLEMENT", "value": 2363},
        {"label": "FOLIC ACID", "value": 257}
    ];

    /* Start - Custom repeating element */
    $('.repeating')
            .append("<input class='btn btn-primary add-section pull-left' type='button' value='+'/>")
            .append("<input class='btn btn-primary remove-section pull-right' type='button' value='-'/><span class='clear'></span>");

    var enableAutoComplete = function(input) {
        $(input).autocomplete({
            source: medications,
            create: function (event, ui) {
                var value = $(this).val();
                $.each(locationName, function (i, element) {
                    if (element.val == value) {
                        $(this).val(element.label);
                    }
                });
            },
            select: function (event, ui) {
                var selectedValue = ui.item.value + "^" + ui.item.label + "^99DCT";
                $(this).val(selectedValue);
                return false;
            }
        }).focus(function () {
            $(this).find('input').select();
            $(this).select();
        });
    };

    var enableAddSection = function(input) {
        $(input).click(function () {
            var $clonedSection = $(this).parent().clone().insertAfter($(this).parent());
            $clonedSection.find(':input:not(:button)').val('');
            $clonedSection.find(':input:not(:button)').trigger('change');
            enableAddSection($clonedSection.find('.add-section'));
            enableRemoveSection($clonedSection.find('.remove-section'));
            enableAutoComplete($clonedSection.find('.current_medication'));
        });
    };

    var enableRemoveSection = function(input) {
        $(input).click(function () {
            var $parent = $(this).parent();
            var _id = $parent.attr('id');
            if ($("." + _id).length > 1) {
                $parent.remove();
            }
        });
    };

    enableAddSection($('.add-section'));
    enableRemoveSection('.remove-section');
    enableAutoComplete($('.current_medication'));
    /* End - Custom repeating element */

});
</script>

</html>
