<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/muzima.css" rel="stylesheet">
    <link href="css/ui-darkness/jquery-ui-1.10.4.custom.min.css" rel="stylesheet">
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui-1.10.4.custom.min.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/additional-methods.min.js"></script>
    <script src="js/muzima.js"></script>
    <title>Histopathology Form v 0.01</title>
</head>
<body class="col-md-10 col-md-offset-1">
<div id="result"></div>
<form class="relevant-female" id="histopathology_form" name="histopathology_form">
    <h2 class="text-center">Histopathology Form v 0.01</h2>

    <div class="section">
        <h3>Patient Demographics</h3>
        <div class="form-group">
            <input class="form-control" id="patient.uuid" hidden="hidden"
                   name="patient.uuid" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.given_name">Given Name:</label>
            <input class="form-control" id="patient.given_name" name="patient.given_name" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.family_name">Family Name:</label>
            <input class="form-control" id="patient.family_name" name="patient.family_name" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.middle_name">Middle Name:</label>
            <input class="form-control" id="patient.middle_name" name="patient.middle_name" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.medical_record_number">AMRS ID Number</label>
            <input class="form-control checkDigit" id="patient.medical_record_number"
                   name="patient.medical_record_number" type="text" readonly="readonly">
        </div>
        <div class="form-group">
            <label for="patient.sex">Gender:</label>
            <select class="form-control" id="patient.sex" name="patient.sex" readonly="readonly">
                <option value="">...</option>
                <option value="M">Male</option>
                <option value="F">Female</option>
            </select>
        </div>
        <div class="form-group">
            <label for="patient.birthdate">Date Of Birth</label>
            <input class="form-control" id="patient.birthdate"
                   name="patient.birthdate" type="text" readonly="readonly">
        </div>
    </div>
    <div class="section">
        <div class="form-group">
            <label for="encounter.location_id">Name of Dispensary:<span class="required">*</span></label>
            <input class="form-control valid-location-only" id="encounter.location_id" type="text" placeholder="Start typing something..." required="required">
            <input class="form-control" name="encounter.location_id" type="hidden">
        </div>

        <div class="form-group hidden">
            <label for="encounter.location_id_select">Screening Site:<span class="required">*</span></label>
            <select class="form-control"  id="encounter.location_id_select" required="required">
                <option>...</option>
                <option value="84" data-location="AMPATH-MTRH">AMPATH-MTRH</option>
                <option value="19" data-location="Busia">Busia</option>
                <option value="7" data-location="Chulaimbo">Chulaimbo</option>
                <option value="17" data-location="Iten">Iten</option>
                <option value="11" data-location="Kitale">Kitale</option>
                <option value="2" data-location="Mosoriot Health Centre">Mosoriot Health Centre</option>
                <option value="20" data-location="Port Victoria">Port Victoria</option>
                <option value="12" data-location="Teso District Hospital">Teso District Hospital</option>
                <option value="3" data-location="Turbo Health Centre">Turbo Health Centre</option>
                <option value="8" data-location="Webuye">Webuye</option>
            </select>
        </div>
        <div class="form-group">
            <label for="encounter.encounter_datetime">Encounter Date:<span class="required">*</span>
            </label>
            <input class="form-control datepicker nonFutureDate" id="encounter.encounter_datetime"
                   name="encounter.encounter_datetime" type="text" readonly="readonly"
                   required="required">
        </div>
        <div class="form-group">
            <input class="form-control" id="encounter.form_uuid" name="encounter.form_uuid" type="hidden"
                   required="required">
        </div>
    </div>
    <div class="section repeat precedure_done_detailed" data-concept="7480^PROCEDURES DONE THIS VISIT, DETAILED^99DCT"
            id="precedure_done_detailed" data-name="precedure_done_detailed">
        <h3>Procedures Done This Visit</h3>

        <div class="form-group">
            <label for="obs.body_part">Body Part Where Specimen Was Collected? <span class="required">*</span></label>
            <select class="form-control" name="obs.body_part" id="obs.body_part" data-concept="8265^BODY PART^99DCT"
                    required="required">
                <option value="">...</option>
                <option value="8279^CERVIX^99DCT">Cervix</option>
                <option value="8280^VAGINA^99DCT">Vagina</option>
                <option value="8281^VULVA^99DCT">Vulva</option>
            </select>
        </div>
        <div class="form-group">
            <label for="obs.procedures_done_this_visit_detailed">How was specimen collected?<span class="required">*</span></label>
            <select class="form-control" name="obs.procedures_done_this_visit_detailed"
                    data-concept="7479^PROCEDURES DONE THIS VISIT^99DCT"
                    id="obs.procedures_done_this_visit_detailed" required="required">
                <option value="">...</option>
                <option value="7147^LOOP ELECTROSURGICAL EXCISION PROCEDURE^99DCT">LEEP</option>
                <option value="6511^EXCISIONAL OR SURGICAL BIOPSY^99DCT">Cervical punch/excisional Biopsy</option>
                <option value="7478^ENDOCERVICAL CURETTAGE ^99DCT">Endocervical curretage (ECC)</option>
            </select>
        </div>
        <div class="form-group ">
            <label for="obs.anatomic_location_description">Provide Location Of Specimen</label>
            <select class="form-control" name="obs.anatomic_location_description"
                    data-concept="8268^ANATOMIC LOCATION DESCRIPTION^99DCT" id="obs.anatomic_location_description"
                    required="required">
                <option value="">...</option>
                <option value="8266^SUPERFICIAL^99DCT">Superficial</option>
                <option value="8267^DEEP^99DCT">Deep</option>
                <option value="5622^OTHER NON-CODED^99DCT">Other non-coded</option>
            </select>
        </div>
        <div class="form-group">
            <label for="obs.clock_face_cervical_biopsy_location">
                Provide location where biopsy for specimen was done: __O'clock</label>
            <input class="form-control" id="obs.clock_face_cervical_biopsy_location"
                   name="obs.clock_face_cervical_biopsy_location"
                   data-concept="7481^CLOCK FACE CERVICAL BIOPSY LOCATION ^99DCT" type="number">
        </div>
        <div class="form-group">
            <label for="obs.pathological_diagnosis_added_cervix">Pathological Diagnosis for Cervical Specimen</label>
            <select class="form-control" data-concept="8278^PATHOLOGICAL DIAGNOSIS ADDED^99DCT"
                    name="obs.pathological_diagnosis_added_cervix"
                    id="obs.pathological_diagnosis_added_cervix" required="required">
                <option>...</option>
                <option value="1115^NORMAL^99DCT">Normal</option>
                <option value="149^CERVICITIS^99DCT">Cervicitis</option>
                <option value="8282^CERVICAL SQUAMOUS METAPLASIA^99DCT">Cervical squamous metaplasia</option>
                <option value="7424^CERVICAL INTRAEPITHELIAL NEOPLASIA GRADE 1^99DCT">
                    Mild cervical intraepithelial neoplasia (CIN 1)
                </option>
                <option value="7425^CERVICAL INTRAEPITHELIAL NEOPLASIA GRADE 2^99DCT">
                    Moderate cervical intraepithelial neoplasia (CIN 2)
                </option>
                <option value="7216^CERVICAL INTRAEPITHELIAL NEOPLASIA GRADE 3^99DCT">
                    Severe cervical intraepithelial neoplasia (CIN 3)
                </option>
                <option value="8275^CERVICAL ADENOCARCINOMA^99DCT">Cervical adenocarcinoma</option>
                <option value="8275^CERVICAL ADENOCARCINOMA^99DCT">Cervical squamous cell carcinoma</option>
                <option value="5622^OTHER NON-CODED^99DCT">Other non-coded</option>
            </select>
        </div>
        <div class="form-group concept">
            <label for="obs.pathological_diagnosis_added_vagina">Pathological Diagnosis for Vaginal Specimen</label>
            <select class="form-control" data-concept="8278^PATHOLOGICAL DIAGNOSIS ADDED^99DCT"
                    name="obs.pathological_diagnosis_added_vagina"
                    id="obs.pathological_diagnosis_added_vagina" required="required">
                <option>...</option>
                <option value="1115^NORMAL^99DCT">Normal</option>
                <option value="7492^VAGINAL INTRAEPITHELIAL NEOPLASIA GRADE 1^99DCT">
                    Mild vaginal intraepithelial neoplasia (VAIN1)
                </option>
                <option value="7491^VAGINAL INTRAEPITHELIAL NEOPLASIA GRADE 2 ^99DCT">
                    Moderate vaginal intraepithelial neoplasia (VAIN 2)
                </option>
                <option value="7435^VAGINAL INTRAEPITHELIAL NEOPLASIA GRADE 3^99DCT">
                    Severe vaginal intraepithelial neoplasia (VAIN 3)
                </option>
                <option value="5622^OTHER NON-CODED^99DCT">Other non-coded</option>
            </select>
        </div>
        <div class="form-group">
            <label for="obs.pathological_diagnosis_added_vulva">Pathological Diagnosis for Vulval Specimen</label>
            <select class="form-control" data-concept="8278^PATHOLOGICAL DIAGNOSIS ADDED^99DCT"
                    name="obs.pathological_diagnosis_added_vulva"
                    id="obs.pathological_diagnosis_added_vulva" required="required">
                <option>...</option>
                <option value="1115^NORMAL^99DCT">Normal</option>
                <option value="7489^CONDYLOMA OR VULVAR INTRAEPITHELIAL NEOPLASIA GRADE 1^99DCT">
                    Condyloma / Mild vulva intraepithelial neoplasia (VIN1)
                </option>
                <option value="7488^VULVAR INTRAEPITHELIAL NEOPLASIA GRADE 2^99DCT">
                    Moderate vulva intraepithelial neoplasia (VIN 2)
                </option>
                <option value="7483^VULVAR INTRAEPITHELIAL NEOPLASIA GRADE 3^99DCT">
                    Severe vulva intraepithelial neoplasia (VIN 3)
                </option>
                <option value="5622^OTHER NON-CODED^99DCT">Other non-coded</option>
            </select>
        </div>
    </div>

    <div class="section">
        <div class="form-group">
            <label for="encounter.provider_id_select">Provider Name:</label>
            <input class="form-control valid-provider-only" id="encounter.provider_id_select" type="text"
                   placeholder="Start typing provider name here ...">
            <input class="form-control" name="encounter.provider_id_select" type="hidden">
        </div>

        <div class="form-group show_provider_id_text">
            <label for="encounter.provider_id">Enter provider's system-id:<span class="required">*</span></label>
            <input class="form-control checkDigit" id="encounter.provider_id" name="encounter.provider_id" type="text"
                   placeholder="Or enter the provider system id here ..." required="required">
        </div>
         <div class="form-group">
            <label for="freetext_general">Comments</label>
            <input class="form-control" name="freetext_general" id="freetext_general"
                      data-concept="1915^FREETEXT GENERAL^99DCT"
                      placeholder="Provider notes/comments.">
        </div>
    </div>
</form>

</body>
<script type="text/javascript">

    $(document).ready(function () {

        var dateFormat = "dd-mm-yy";
        var currentDate = $.datepicker.formatDate(dateFormat, new Date());
        var encounterDatetime = $('#encounter\\.encounter_datetime');
        if ($(encounterDatetime).val() == "") {
            $(encounterDatetime).val(currentDate);
        }

        $('#save_draft').click(function () {
            $(this).prop('disabled', true);
            document.saveDraft(this);
            $(this).prop('disabled', false);
        });

        $('#submit_form').click(function () {
            $(this).prop('disabled', true);
            document.submit();
            $(this).prop('disabled', false);
        });

        var locationName = [
        {"val": "7", "label": "Chulaimbo"},
        {"val": "3", "label": "Turbo"},
        {"val": "17", "label": "Iten"},
        {"val": "2", "label": "Mosoriot"},
        {"val": "8", "label": "Webuye"},
        {"val": "84", "label": "Ampath MTRH"},
        {"val": "11", "label": "Kitale"},
        {"val": "19", "label": "Busia"}
        ];

        document.setupAutoCompleteData('encounter\\.location_id');

        var provider = [
            {"label": "Daurine Achieng Agumba", "val": "3419-9"},
            {"label": "Irene Chepkosgei Kurgat", "val": "3420-7"},
            {"label": "Rose Cheruto Toroitich", "val": "3421-5"},
            {"label": "Mary Kipkurui Kimosop", "val": "3422-3"},
            {"label": "Jacqueline Chemom Ndiema", "val": "3423-1"},
            {"label": "Grace Wanjiru Mwangi", "val": "3424-9"},
            {"label": "Collette Mabia Palapala", "val": "3425-6"},
            {"label": "Dorice Erima Wekesa", "val": "3426-4"},
            {"label": "Agnes Kagure Boen", "val": "120-6"},
            {"label": "Linet Kerubo Onyancha", "val": "3427-2"},
            {"label": "Delinah Muchai Tanui", "val": "1208-8"},
            {"label": "Hellen Mushimbi Indumbwe", "val": "3321-7"},
            {"label": "Lydia Cherugut Samoei", "val": "1525-5"},
            {"label": "Ruth Kalunda Nzili", "val": "1529-7"},
            {"label": "Lucy Cheruto Birgen", "val": "3428-0"},
            {"label": "Gratiah Nafuna Khaemba", "val": "1409-2"},
            {"label": "Leonida Chemutai Mengich", "val": "1357-3"},
            {"label": "Ann Wangoi Maina", "val": "1412-6"},
            {"label": "Elkanah Omenge Orango", "val": "1474-6"},
            {"label": "Peter Mukhanadale Istura", "val": "1478-7"},
            {"label": "Hillary Mabeya", "val": "1476-1"},
            {"label": "Astrid Christoffersen Deb", "val": "1237-7"},
            {"label": "Philip Kipkirui Tonui", "val": "1485-7"},
            {"label": "Ann Jebet Ngelel", "val": "3613-7"},
            {"label": "Job Wekesa Wamukaya", "val": "3614-5"},
            {"label": "Joyce Chepkorir Chessum", "val": "3615-2"},
            {"label": "Monica Chelimo Rotich", "val": "3616-0"},
            {"label": "Penina Jerotich Biwott", "val": "3617-8"},
            {"label": "Peter Gachingi Kamau", "val": "3618-6"},
            {"label": "Phanice Jepkemoi Tomu", "val": "3619-4"},
            {"label": "Phyllis Jelagat Bartilol", "val": "3620-2"},
            {"label": "Roselyne Yatich", "val": "3621-0"},
            {"label": "Ruth Sego", "val": "3622-8"},
            {"label": "Yosabia Osebe Monari", "val": "3623-6"},
            {"label": "Philip Kipkirui Tonui", "val": "1485-7"}
        ];


        document.setupAutoCompleteForProvider('encounter\\.provider_id_select', provider);

        $('#encounter\\.provider_id_select').change(function () {
            if ($('#encounter\\.provider_id_select').val() === '') {
                $('#encounter\\.provider_id').val('');
                $('.show_provider_id_text').show();
            }
        });

        $('#histopathology_form').validate({});

        var $patientSex = $('#patient\\.sex');
        $patientSex.change(function () {
            var $womenOnly = $('.relevant-female');
            if ($patientSex.val() != 'F') {
                $womenOnly.hide();
                $('body').html("<div class='section text-center'><h4>This form is only applicable to female patient. " +
                        "Please press back to close the form.</h4></div>");
            } else {
                $womenOnly.show();
            }
        });
        $patientSex.trigger('change');

        var showBodyPartSpecificDiagonosis = function (bodyPart) {
            var availableBodyParts = {'8279^CERVIX^99DCT': '#obs\\.pathological_diagnosis_added_cervix',
                '8280^VAGINA^99DCT': '#obs\\.pathological_diagnosis_added_vagina',
                '8281^VULVA^99DCT': '#obs\\.pathological_diagnosis_added_vulva'};

            $.each(availableBodyParts, function (k, v) {
                if (k == bodyPart && k !== '') {
                    $(v).parent().show();
                } else {
                    $(v).val('');
                    $(v).parent().hide();
                }
            })
        };
        var $bodyPart = $('#obs\\.body_part');
        $bodyPart.change(function () {
            showBodyPartSpecificDiagonosis($bodyPart.val());
        });
        $bodyPart.trigger('change');

        var $obs = $('#obs\\.procedures_done_this_visit_detailed');
        $obs.change(function () {
            var procedure = $('#obs\\.procedures_done_this_visit_detailed').val();
            if (procedure === "") {
                $('#obs\\.clock_face_cervical_biopsy_location').parent().hide();
                $('#obs\\.anatomic_location_description').parent().hide();
            } else {
                if ($('#obs\\.procedures_done_this_visit_detailed').val() == "7147^LOOP ELECTROSURGICAL EXCISION PROCEDURE^99DCT") {
                    $('#obs\\.anatomic_location_description').parent().show();
                    $('#obs\\.clock_face_cervical_biopsy_location').parent().hide();
                } else {
                    $('#obs\\.clock_face_cervical_biopsy_location').parent().show();
                    $('#obs\\.anatomic_location_description').parent().hide();
                }
            }
        });
        $obs.trigger('change');


    document.setupValidationForProvider("$('#encounter\\.provider_id_select').val()","encounter\\.provider_id",provider);
    document.setupValidationForLocation("$('#encounter\\.location_id').val()","encounter\\.location_id");

    });
</script>

</html>